diff -ruN nginx-sorted-querystring-module-0.2.orig/config nginx-sorted-querystring-module-0.2/config
--- nginx-sorted-querystring-module-0.2.orig/config	2015-10-14 15:38:06.000000000 +0000
+++ nginx-sorted-querystring-module-0.2/config	2016-02-11 22:21:19.164029398 +0000
@@ -1,3 +1,13 @@
 ngx_addon_name=ngx_http_sorted_querystring_module
-HTTP_MODULES="$HTTP_MODULES $ngx_addon_name"
-NGX_ADDON_SRCS="$NGX_ADDON_SRCS $ngx_addon_dir/$ngx_addon_name.c"
+SORTED_QUERYSTRING_SRCS="$ngx_addon_dir/ngx_http_sorted_querystring_module.c"
+
+if [ -n "$ngx_module_link" ]; then
+    ngx_module_type=HTTP
+    ngx_module_name="$ngx_addon_name"
+    ngx_module_srcs="$SORTED_QUERYSTRING_SRCS"
+
+    . auto/module
+else
+    HTTP_MODULES="$HTTP_MODULES $ngx_addon_name"
+    NGX_ADDON_SRCS="$NGX_ADDON_SRCS $SORTED_QUERYSTRING_SRCS"
+fi
