--- nginx-rtmp-module-master.orig/ngx_rtmp_core_module.c	2016-03-07 05:44:44.000000000 +0000
+++ nginx-rtmp-module-master/ngx_rtmp_core_module.c	2016-06-28 02:27:49.437818079 +0000
@@ -545,7 +545,11 @@
             break;
         }
 
+#if (nginx_version >= 1011000)
+        if (ngx_memcmp(ls[i].sockaddr + off, &u.sockaddr + off, len) != 0) {
+#else
         if (ngx_memcmp(ls[i].sockaddr + off, u.sockaddr + off, len) != 0) {
+#endif
             continue;
         }
 
@@ -565,7 +569,11 @@
 
     ngx_memzero(ls, sizeof(ngx_rtmp_listen_t));
 
+#if (nginx_version >= 1011000)
+    ngx_memcpy(ls->sockaddr, &u.sockaddr, u.socklen);
+#else
     ngx_memcpy(ls->sockaddr, u.sockaddr, u.socklen);
+#endif
 
     ls->socklen = u.socklen;
     ls->wildcard = u.wildcard;
